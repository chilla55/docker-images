	github.com/chilla55/proxy-manager		coverage: 0.0% of statements
	github.com/chilla55/proxy-manager/accesslog		coverage: 0.0% of statements
=== RUN   TestNewAggregator
--- PASS: TestNewAggregator (0.00s)
=== RUN   TestAddSample
--- PASS: TestAddSample (0.00s)
=== RUN   TestAggregate
--- PASS: TestAggregate (0.00s)
=== RUN   TestWindowSize
--- PASS: TestWindowSize (0.00s)
=== RUN   TestResponseTimePercentiles
--- PASS: TestResponseTimePercentiles (0.00s)
PASS
coverage: 82.7% of statements
ok  	github.com/chilla55/proxy-manager/analytics	0.930s	coverage: 82.7% of statements
	github.com/chilla55/proxy-manager/audit		coverage: 0.0% of statements
	github.com/chilla55/proxy-manager/certmonitor		coverage: 0.0% of statements
=== RUN   TestLoadGlobalConfig
--- PASS: TestLoadGlobalConfig (0.00s)
=== RUN   TestLoadSiteConfigValidateAndOptions
--- PASS: TestLoadSiteConfigValidateAndOptions (0.00s)
PASS
coverage: 57.3% of statements
ok  	github.com/chilla55/proxy-manager/config	0.922s	coverage: 57.3% of statements
	github.com/chilla55/proxy-manager/database		coverage: 0.0% of statements
	github.com/chilla55/proxy-manager/health		coverage: 0.0% of statements
=== RUN   TestCollectorRecordRequestAndStats
--- PASS: TestCollectorRecordRequestAndStats (0.00s)
=== RUN   TestPrometheusMetricsContainsKeys
--- PASS: TestPrometheusMetricsContainsKeys (0.00s)
PASS
coverage: 89.8% of statements
ok  	github.com/chilla55/proxy-manager/metrics	0.874s	coverage: 89.8% of statements
	github.com/chilla55/proxy-manager/middleware		coverage: 0.0% of statements
	github.com/chilla55/proxy-manager/nginx		coverage: 0.0% of statements
	github.com/chilla55/proxy-manager/pii		coverage: 0.0% of statements
	github.com/chilla55/proxy-manager/proxy		coverage: 0.0% of statements
=== RUN   TestAllowMinuteLimit
--- PASS: TestAllowMinuteLimit (0.00s)
=== RUN   TestAllowHourlyLimit
--- PASS: TestAllowHourlyLimit (0.00s)
=== RUN   TestMiddlewareWithXFF
{"level":"warn","ip":"203.0.113.1","route":"/route","reason":"exceeded 2 requests per minute (current: 2)","time":"2025-12-18T12:08:07+01:00","message":"Rate limit exceeded"}
--- PASS: TestMiddlewareWithXFF (0.00s)
=== RUN   TestWhitelistCIDR
{"level":"info","ip_or_cidr":"203.0.113.0/24","time":"2025-12-18T12:08:07+01:00","message":"Added to rate limit whitelist"}
--- PASS: TestWhitelistCIDR (0.00s)
=== RUN   TestGetStats
--- PASS: TestGetStats (0.00s)
PASS
coverage: 68.8% of statements
ok  	github.com/chilla55/proxy-manager/ratelimit	1.008s	coverage: 68.8% of statements
	github.com/chilla55/proxy-manager/registry		coverage: 0.0% of statements
	github.com/chilla55/proxy-manager/retention		coverage: 0.0% of statements
=== RUN   TestNewAnalyzer
--- PASS: TestNewAnalyzer (0.00s)
=== RUN   TestRecordRequest
--- PASS: TestRecordRequest (0.00s)
=== RUN   TestGetAnalysis
--- PASS: TestGetAnalysis (0.00s)
=== RUN   TestGetIPReputation
--- PASS: TestGetIPReputation (0.00s)
PASS
coverage: 72.6% of statements
ok  	github.com/chilla55/proxy-manager/traffic	0.797s	coverage: 72.6% of statements
	github.com/chilla55/proxy-manager/updater		coverage: 0.0% of statements
=== RUN   TestMiddlewareBlocksMaliciousPath
{"level":"warn","ip":"192.0.2.1","route":"/api","attack_type":"xss","payload":"<script>alert('x')</script>","time":"2025-12-18T12:08:07+01:00","message":"WAF blocked attack"}
--- PASS: TestMiddlewareBlocksMaliciousPath (0.00s)
=== RUN   TestLogOnlyModeAllows
{"level":"warn","ip":"192.0.2.1","route":"/api","attack_type":"xss","payload":"<script>alert('x')</script>","time":"2025-12-18T12:08:07+01:00","message":"WAF blocked attack"}
{"level":"info","time":"2025-12-18T12:08:07+01:00","message":"WAF in log-only mode, allowing request"}
--- PASS: TestLogOnlyModeAllows (0.00s)
=== RUN   TestHeaderInspection
{"level":"warn","ip":"192.0.2.1","route":"/hdr","attack_type":"xss","payload":"X-Whatever: javascript:","time":"2025-12-18T12:08:07+01:00","message":"WAF blocked attack"}
--- PASS: TestHeaderInspection (0.00s)
=== RUN   TestQueryInspection
{"level":"warn","ip":"192.0.2.1","route":"/q","attack_type":"path_traversal","payload":"q=../","time":"2025-12-18T12:08:07+01:00","message":"WAF blocked attack"}
--- PASS: TestQueryInspection (0.00s)
=== RUN   TestGetStats
--- PASS: TestGetStats (0.00s)
PASS
coverage: 66.7% of statements
ok  	github.com/chilla55/proxy-manager/waf	0.797s	coverage: 66.7% of statements
	github.com/chilla55/proxy-manager/watcher		coverage: 0.0% of statements
